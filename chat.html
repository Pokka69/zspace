<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Chat Access - Ka Version</title>

<style>
* { box-sizing: border-box; }
body { margin: 0; background: #000; color: #fff; font-family: system-ui, -apple-system, sans-serif; height: 100vh; display: flex; flex-direction: column; }

.chat { flex: 1; padding: 16px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }

/* Bubble Chat */
.msg { max-width: 85%; padding: 12px 16px; border-radius: 18px; font-size: 15px; position: relative; line-height: 1.4; }
.bot { background: #1c1c1e; align-self: flex-start; border-bottom-left-radius: 4px; }
.user { background: #007aff; align-self: flex-end; border-bottom-right-radius: 4px; }

/* Info Inside Chat */
.info-inside { margin-top: 10px; padding-top: 10px; border-top: 1px solid #333; }
.info-inside p { margin: 5px 0; font-size: 13px; color: #aaa; }
.info-row { display: flex; align-items: center; gap: 10px; margin-top: 8px; }
.btn-info { background: #444; color: #fff; border: none; padding: 5px 12px; border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 11px; }
.info-label { font-size: 11px; color: #666; }

/* Input area */
.input-box { position: sticky; bottom: 0; display: flex; gap: 10px; padding: 12px; background: #000; border-top: 1px solid #222; align-items: center; }
input { flex: 1; padding: 14px; background: #1c1c1e; border: none; color: #fff; border-radius: 999px; outline: none; font-size: 16px; text-align: center; letter-spacing: 4px; }
.btn-send { background: #007aff; border: none; color: #fff; border-radius: 50%; width: 45px; height: 45px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
.btn-del { background: #1c1c1e; color: #ff3b30; border: none; font-size: 20px; cursor: pointer; padding: 10px; }

/* Modal Popup Style */
.modal { display: none; position: fixed; z-index: 100; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); align-items: center; justify-content: center; }
.modal-content { background: #1c1c1e; padding: 25px; border-radius: 20px; width: 85%; max-width: 320px; text-align: center; border: 1px solid #333; }
.modal-content p { font-size: 14px; color: #ccc; line-height: 1.6; }
.btn-close { background: #007aff; color: #fff; border: none; padding: 10px 20px; border-radius: 10px; margin-top: 20px; cursor: pointer; font-weight: bold; }
</style>
</head>

<body>

<div class="chat" id="chat"></div>

<div id="infoModal" class="modal">
    <div class="modal-content">
        <h3 style="margin-top:0">Maklumat Akses</h3>
        <p>+ Tekan tombol Masuk untuk mendapatkan link Video.<br>+ File hanya disediakan di MEGA (Tersedia di PlayStore).</p>
        <button class="btn-close" onclick="closePopup()">FAHAM</button>
    </div>
</div>

<div class="input-box">
  <button class="btn-del" onclick="clearHistory()" title="Delete Sejarah">üóëÔ∏è</button>
  <input id="code" type="tel" inputmode="numeric" maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" autofocus>
  <button class="btn-send" onclick="send()">‚û§</button>
</div>

<script>
const accessMap = { "1234": "file.html", "5678": "page-b.html", "9999": "admin.html" };
const chat = document.getElementById("chat");

function openPopup() { document.getElementById("infoModal").style.display = "flex"; }
function closePopup() { document.getElementById("infoModal").style.display = "none"; }

function addMsg(text, cls, hasInfo = false) {
    const div = document.createElement("div");
    div.className = "msg " + cls;
    let content = `<div>${text}</div>`;

    if (hasInfo) {
        content += `
            <div class="info-inside">
                <p>Tidak tahu cara untuk mainkan video?</p>
                <p>Tidak tahu di mana file akan disediakan?</p>
                <div class="info-row">
                    <button class="btn-info" onclick="openPopup()">INFO</button>
                    <span class="info-label">Tekan ini untuk maklumat</span>
                </div>
            </div>
        `;
    }

    div.innerHTML = content;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
    saveChat();
}

function send() {
    const input = document.getElementById("code");
    const value = input.value.trim();
    if (value.length !== 4) return;

    addMsg("‚Ä¢‚Ä¢‚Ä¢‚Ä¢", "user");
    input.value = "";

    setTimeout(() => {
        if (accessMap[value]) {
            addMsg("Akses diterima. Mengalihkan ke kandungan...", "bot");
            setTimeout(() => { location.href = accessMap[value]; }, 1000);
        } else {
            addMsg("Kod tidak sah... Sila cuba lagi.", "bot");
        }
    }, 500);
}

function saveChat() { localStorage.setItem("chat_history", chat.innerHTML); }

function clearHistory() {
    if(confirm("Adakan kamu akan meneruskan?")) {
        localStorage.removeItem("chat_history");
        chat.innerHTML = "";
        addMsg("Selamat Datang! Sila Masukkan Kod Untuk Mendapatkan Kandungan. KOD 4 DIGIT.", "bot", true);
    }
}

window.onload = () => {
    const saved = localStorage.getItem("chat_history");
    if (saved) {
        chat.innerHTML = saved;
    } else {
        addMsg("Selamat Datang! Sila Masukkan Kod Untuk Mendapatkan Kandungan. KOD 4 DIGIT.", "bot", true);
    }
}
</script>

</body>
</html>
