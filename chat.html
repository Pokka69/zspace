<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Chat Access</title>

<style>
* { box-sizing: border-box; }
body { margin: 0; background: #000; color: #fff; font-family: system-ui, -apple-system, sans-serif; height: 100vh; display: flex; flex-direction: column; }

.chat { flex: 1; padding: 16px; overflow-y: auto; display: flex; flex-direction: column; gap: 15px; }

/* Bubble Chat dengan Ekor (Tail) */
.msg { 
    max-width: 85%; 
    padding: 12px 16px; 
    border-radius: 18px; 
    font-size: 15px; 
    position: relative; 
    line-height: 1.4;
}

/* Bot Style (Kelabu Gelap) */
.bot { 
    background: #1c1c1e; 
    align-self: flex-start; 
    border-bottom-left-radius: 4px; 
}

/* User Style (Biru) */
.user { 
    background: #007aff; 
    align-self: flex-end; 
    border-bottom-right-radius: 4px; 
}

/* Gaya Kotak Info di dalam Chat */
.info-inside {
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid #333;
}
.info-inside p { margin: 5px 0; font-size: 13px; color: #aaa; }
.info-row { display: flex; align-items: center; gap: 10px; margin-top: 8px; }
.btn-info { 
    background: #444; color: #fff; border: none; padding: 5px 12px; 
    border-radius: 6px; font-weight: bold; cursor: pointer; font-size: 11px;
}
.info-label { font-size: 11px; color: #666; }

/* Input area */
.input-box { position: sticky; bottom: 0; display: flex; gap: 10px; padding: 12px; background: #000; border-top: 1px solid #222; }
input { flex: 1; padding: 14px; background: #1c1c1e; border: none; color: #fff; border-radius: 999px; outline: none; font-size: 16px; text-align: center; letter-spacing: 4px; }
button { background: #007aff; border: none; color: #fff; padding: 0 18px; border-radius: 50%; font-size: 18px; cursor: pointer; width: 45px; height: 45px; }
</style>
</head>

<body>

<div class="chat" id="chat">
    </div>

<div class="input-box">
  <input id="code" type="tel" inputmode="numeric" maxlength="4" placeholder="••••" autofocus>
  <button onclick="send()">➤</button>
</div>

<script>
const accessMap = {
  "1234": "file.html",
  "5678": "page-b.html",
  "9999": "admin.html"
};

const chat = document.getElementById("chat");

// Function utama untuk tambah mesej (Bot/User)
function addMsg(text, cls, hasInfo = false) {
    const div = document.createElement("div");
    div.className = "msg " + cls;
    
    let content = `<div>${text}</div>`;
    
    // Kalau ada info (untuk mesej pertama), kita masukkan sekali dalam bubble
    if (hasInfo) {
        content += `
            <div class="info-inside">
                <p>Tidak tahu cara untuk mainkan video?</p>
                <p>Tidak tahu di mana file akan disediakan?</p>
                <div class="info-row">
                    <button class="btn-info" onclick="alert('+ Tekan Mana-mana butang untuk mainkan video. + File hanya disediakan di MEGA (Tersedia di PlayStore) ')">INFO</button>
                    <span class="info-label">Tekan ini untuk maklumat</span>
                </div>
            </div>
        `;
    }
    
    div.innerHTML = content;
    chat.appendChild(div);
    chat.scrollTop = chat.scrollHeight;
    saveChat();
}

function send() {
    const input = document.getElementById("code");
    const value = input.value.trim();

    if (value.length !== 4) return;

    addMsg("••••", "user");
    input.value = "";

    setTimeout(() => {
        if (accessMap[value]) {
            addMsg("Akses diterima. Mengalihkan ke kandungan...", "bot");
            setTimeout(() => { location.href = accessMap[value]; }, 1000);
        } else {
            addMsg("Kod tidak sah... Sila cuba lagi.", "bot");
        }
    }, 500);
}

function saveChat() {
    localStorage.setItem("chat_history", chat.innerHTML);
}

// Bila buka page:
window.onload = () => {
    const saved = localStorage.getItem("chat_history");
    if (saved) {
        chat.innerHTML = saved;
    } else {
        // Mesej pertama kali buka (Mesej Bot + Info Box)
        addMsg("Selamat Datang! Sila Masukkan Kod Untuk Mendapatkan Kandungan. KOD 4 DIGIT.", "bot", true);
    }
}
</script>

</body>
</html>
