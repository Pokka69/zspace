<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ka-Tok | Homepage</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
    background:#000;
    color:#fff;
    font-family:Arial, sans-serif;
}

.top{
    position:fixed;
    top:0;
    width:100%;
    height:50px;
    background:#111;
    display:flex;
    justify-content:space-between;
    align-items:center;
    padding:0 15px;
    border-bottom:1px solid #222;
    z-index:10;
}

.content{
    padding:60px 10px 70px;
}

.file{
    background:#111;
    margin-bottom:10px;
    padding:12px;
    border-radius:8px;
    cursor:pointer;
}

.file:hover{
    background:#161616;
}

.file h4{margin-bottom:5px;}
.file small{color:#aaa;}

.bottom{
    position:fixed;
    bottom:0;
    width:100%;
    height:55px;
    background:#111;
    display:flex;
    border-top:1px solid #222;
}

.bottom div{
    flex:1;
    text-align:center;
    line-height:55px;
}

.popup{
    position:fixed;
    top:0;left:0;
    width:100%;height:100%;
    background:rgba(0,0,0,.7);
    display:none;
    justify-content:center;
    align-items:center;
    z-index:20;
}

.popup .box{
    background:#111;
    padding:20px;
    border-radius:12px;
    width:90%;
    max-width:420px;
    max-height:80vh;
    overflow:auto;
}

button{
    width:100%;
    padding:10px;
    margin-top:10px;
    border:none;
    border-radius:8px;
    background:#ff0055;
    color:#fff;
}

input{
    width:100%;
    padding:10px;
    border-radius:8px;
    border:none;
    outline:none;
}

.req{
    background:#000;
    margin-top:8px;
    padding:8px;
    border-radius:6px;
    display:flex;
    justify-content:space-between;
    align-items:center;
}

.kick{
    background:#ff3333;
    padding:4px 10px;
    border-radius:6px;
    font-size:12px;
}
</style>
</head>

<body>

<div class="top">
    <b>Ka-Tok</b>
    <div>
        <span id="user" onclick="logout()"></span>
        <span id="adminIcon" onclick="openAdmin()" style="margin-left:15px;display:none;">ðŸ›¡</span>
    </div>
</div>

<div class="content" id="content"></div>

<div class="bottom">
    <div onclick="loadForYou()">For You</div>
    <div onclick="loadNew()">New</div>
</div>

<!-- ADMIN PANEL -->
<div class="popup" id="adminBox">
<div class="box">
    <h3>Admin Panel</h3>
    <input id="pin" placeholder="Masukkan PIN 4 digit">
    <button onclick="verify()">Masuk</button>
    <div id="reqList"></div>
</div>
</div>

<script>
let user = localStorage.getItem("user");
if(!user) window.location.href="index.html";

document.getElementById("user").innerHTML = user;

/* HANYA ADMIN NAMPAK ICON */
if(user === "@admin69"){
    document.getElementById("adminIcon").style.display="inline";
} else {
    document.getElementById("adminIcon").remove();
}

/* LOGOUT */
function logout(){
    if(confirm("Log out?")){
        localStorage.removeItem("login");
        localStorage.removeItem("user");
        window.location.href="index.html";
    }
}

/* =============================== */
/* ===== LIST FILE (EDIT SINI) === */
/* =============================== */

let forYouFiles = [
    {title:"File 1", info:"Info ringkas file 1", link:"file1.html"},
    {title:"File 2", info:"Info ringkas file 2", link:"file2.html"},
    {title:"File 3", info:"Info ringkas file 3", link:"file3.html"},
    {title:"File 4", info:"Info ringkas file 4", link:"file4.html"},
    {title:"File 5", info:"Info ringkas file 5", link:"file5.html"}
];

let newFolders = [
    {title:"Folder 1", info:"Folder baru", link:"folder1.html"},
    {title:"Folder 2", info:"Folder baru", link:"folder2.html"},
    {title:"Folder 3", info:"Folder baru", link:"folder3.html"},
    {title:"Folder 4", info:"Folder baru", link:"folder4.html"},
    {title:"Folder 5", info:"Folder baru", link:"folder5.html"}
];

/* LOAD CONTENT */
function loadForYou(){
    let html="";
    forYouFiles.forEach(f=>{
        html+=`
        <div class="file" onclick="openLink('${f.link}')">
            <h4>${f.title}</h4>
            <small>${f.info}</small>
        </div>`;
    });
    document.getElementById("content").innerHTML=html;
}

function loadNew(){
    let html="";
    newFolders.forEach(f=>{
        html+=`
        <div class="file" onclick="openLink('${f.link}')">
            <h4>${f.title}</h4>
            <small>${f.info}</small>
        </div>`;
    });
    document.getElementById("content").innerHTML=html;
}

function openLink(link){
    window.location.href = link;
}

loadForYou();

/* ADMIN PANEL PROTECTION */
function openAdmin(){
    if(localStorage.getItem("user") !== "@admin69") return;
    document.getElementById("adminBox").style.display="flex";
}

function verify(){
    if(document.getElementById("pin").value !== "0808"){
        alert("PIN salah");
        return;
    }
    showRequests();
}

/* SHOW REQUEST + APPROVED LIST */
function showRequests(){
    let users = JSON.parse(localStorage.getItem("users") || "{}");
    let html="<h4>Pending</h4>";

    let pending=false;

    for(let u in users){
        if(users[u] === "pending"){
            pending=true;
            html += `
            <div class="req">
                ${u}
                <button onclick="approve('${u}')">Lulus</button>
            </div>`;
        }
    }

    if(!pending){
        html+="<small>Tiada permintaan</small>";
    }

    html+="<hr style='margin:15px 0;border-color:#222'>";
    html+="<h4>Approved (Terkini di atas)</h4>";

    let approved = JSON.parse(localStorage.getItem("approvedList")||"[]");
    approved.reverse().forEach(u=>{
        html+=`
        <div class="req">
            ${u}
            <button class="kick" onclick="kick('${u}')">Kick</button>
        </div>`;
    });

    document.getElementById("reqList").innerHTML = html;
}

function approve(user){
    let users = JSON.parse(localStorage.getItem("users"));
    users[user] = "approved";
    localStorage.setItem("users", JSON.stringify(users));

    let approved = JSON.parse(localStorage.getItem("approvedList")||"[]");
    approved.push(user);
    localStorage.setItem("approvedList",JSON.stringify(approved));

    alert(user+" diluluskan");
    showRequests();
}

function kick(user){
    if(!confirm("Kick "+user+" ?")) return;

    let users = JSON.parse(localStorage.getItem("users"));
    delete users[user];
    localStorage.setItem("users", JSON.stringify(users));

    let approved = JSON.parse(localStorage.getItem("approvedList")||"[]");
    approved = approved.filter(u=>u!==user);
    localStorage.setItem("approvedList",JSON.stringify(approved));

    alert(user+" telah dikick");
    showRequests();
}
</script>

</body>
</html>